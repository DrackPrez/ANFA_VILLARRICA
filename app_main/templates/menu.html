{% load static %}
<!DOCTYPE html>
<html lang="es"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>ANFA Villarrica</title>
<link rel="icon" type="image/png" href="{% static 'img/logo-anfa-villarrica.png' %}"/>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
<style>
    body {
        background: linear-gradient(135deg, #2d1b1b 0%, #7c1d1d 100%);
        padding-top: 140px; /* Increased space for mobile header */
    }
    .sticky-header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 100;
        backdrop-filter: blur(10px);
        background: rgba(17, 24, 39, 0.95);
        border-bottom: 1px solid rgba(220, 38, 38, 0.3);
    }
    .sponsor-logos {
        background: linear-gradient(135deg, rgba(220, 38, 38, 0.1) 0%, rgba(239, 68, 68, 0.1) 100%);
        border: 1px solid rgba(220, 38, 38, 0.2);
        border-radius: 12px;
        padding: 8px 12px;
        backdrop-filter: blur(5px);
        box-shadow: 0 4px 20px rgba(220, 38, 38, 0.1);
    }
    .sponsor-logo {
        transition: all 0.3s ease;
        filter: brightness(0.9) contrast(1.1);
        border-radius: 6px;
        background: rgba(255, 255, 255, 0.05);
        padding: 4px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    .sponsor-logo:hover {
        transform: translateY(-2px) scale(1.05);
        filter: brightness(1.1) contrast(1.2);
        box-shadow: 0 8px 25px rgba(220, 38, 38, 0.3);
    }
    @media (max-width: 768px) {
        body {
            padding-top: 160px;
        }
        .sponsor-logos {
            padding: 6px 8px;
            border-radius: 8px;
        }
        .sponsor-logo {
            padding: 3px;
        }
    }
    .line-clamp-3 {
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    .preserve-whitespace {
        white-space: pre-line;
    }
</style>
</head>
<body class="text-gray-100">
<div class="container mx-auto p-4 bg-gray-900 bg-opacity-95 rounded-xl shadow-lg">
<header class="sticky-header flex flex-col lg:flex-row justify-between items-center p-3 lg:p-4 space-y-3 lg:space-y-0">
<div class="flex items-center justify-center lg:justify-start w-full lg:w-auto">
<img alt="Logo ANFA" class="h-16 w-16 lg:h-24 lg:w-24 mr-3 lg:mr-4" src="{% static 'img/anfa.png' %}"/>
<div class="text-center lg:text-left">
<h1 class="text-xl lg:text-3xl font-extrabold text-red-600 drop-shadow">ANFA Villarrica</h1>
<p class="text-xs lg:text-sm text-gray-300">Liga deportiva</p>
<p class="text-xs lg:text-sm text-gray-300 hidden lg:block">Asociación de Fútbol de Villarrica</p>
</div>
</div>

<!-- Logos patrocinadores en el centro -->
<div class="sponsor-logos flex items-center justify-center space-x-2 sm:space-x-4 lg:space-x-6 w-full lg:w-auto">
    
    <img alt="Andes Asesorías" class="sponsor-logo h-10 w-10 sm:h-12 sm:w-12 lg:h-14 lg:w-14 object-contain" src="{% static 'img/andes.png' %}"/>
    <img alt="Novena Medios" class="sponsor-logo h-10 w-10 sm:h-12 sm:w-12 lg:h-14 lg:w-14 object-contain" src="{% static 'img/novena.png' %}"/>
    <img alt="Demarca Sport" class="sponsor-logo h-10 w-10 sm:h-12 sm:w-12 lg:h-14 lg:w-14 object-contain" src="{% static 'img/demarca.png' %}"/>
</div>

<div class="flex space-x-2 sm:space-x-3 lg:space-x-4 justify-center lg:justify-end w-full lg:w-auto">
    <a href="https://www.instagram.com/anfavillarrica?igsh=MTYyeTczem44dXNhcg==/" target="_blank" rel="noopener noreferrer">
        <img alt="Instagram" class="h-8 w-8 lg:h-10 lg:w-10" src="{% static 'img/instagram-icon.svg' %}"/>
    </a>
    <a href="https://www.facebook.com/" target="_blank" rel="noopener noreferrer">
        <img alt="Facebook" class="h-8 w-8 lg:h-10 lg:w-10" src="{% static 'img/facebook-icon.svg' %}"/>
    </a>
    <!-- Botones de autenticación -->
    {% if user.is_authenticated %}
        <form action="{% url 'logout' %}" method="post" class="inline">
            {% csrf_token %}
            <button type="submit" class="bg-red-600 hover:bg-red-700 text-white font-semibold px-2 py-1 sm:px-3 sm:py-2 lg:px-4 lg:py-2 rounded-lg shadow transition text-xs sm:text-sm">
                Cerrar sesión
            </button>
        </form>
    {% else %}
        <a href="{% url 'login' %}" class="bg-red-600 hover:bg-red-700 text-white font-semibold px-2 py-1 sm:px-3 sm:py-2 lg:px-4 lg:py-2 rounded-lg shadow transition text-xs sm:text-sm">
            Iniciar sesión
        </a>
    {% endif %}
</div>
</header>
<main>
<section class="mb-12 p-6 border-2 border-red-700 rounded-lg bg-gray-800 bg-opacity-80">
<h2 class="text-xl font-semibold mb-2 text-center text-red-300">QUIÉNES SOMOS</h2>
<p class="text-gray-200 text-center mb-4">La ANFA Villarrica (Asociación de Fútbol de Villarrica) es la liga deportiva que agrupa a 10 clubes asociados en Villarrica. Organizamos el Campeonato ANFA Villarrica 2025 @demarca_sport en el Estadio Municipal de Villarrica, promoviendo la pasión y el desarrollo del fútbol local.</p>
<div class="text-center p-4 border border-dashed border-red-700 rounded-md bg-gray-900 bg-opacity-80">
    <p class="text-2xl font-bold text-white mb-4 tracking-wide">DIRECTORIO</p>
    <div class="flex flex-col md:flex-row justify-center items-center gap-4 mt-4">
        <a href="{% url 'clubes' %}" class="bg-white text-red-700 font-semibold px-6 py-3 rounded-lg shadow hover:bg-red-100 transition">Gestion de Clubes</a>
        
    </div>
</div>
</section>

<!-- NUEVO: Sección de Novedades -->
<section class="mb-12 p-6 border-2 border-blue-500 rounded-lg bg-gray-800 bg-opacity-80">
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-xl font-semibold text-blue-300 flex items-center gap-2">
            <span class="material-icons">newspaper</span>
            NOVEDADES
        </h2>
        {% if user.is_authenticated %}
            <button onclick="openAddNovedadModal()" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2 rounded-lg shadow transition flex items-center gap-2">
                <span class="material-icons text-sm">add</span>
                Agregar Noticia
            </button>
        {% endif %}
    </div>
    
    {% if novedades_recientes %}
        <div class="relative overflow-hidden pb-3">
            <!-- Botones de navegación -->
            {% if novedades_recientes|length > 1 %}
            <button id="novedadesPrevBtn" onclick="moveNovedadesCarousel('prev')" class="absolute left-0 top-1/2 transform -translate-y-1/2 z-10 bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-full shadow-lg transition-all duration-300 opacity-80 hover:opacity-100">
                <span class="material-icons">chevron_left</span>
            </button>
            <button id="novedadesNextBtn" onclick="moveNovedadesCarousel('next')" class="absolute right-0 top-1/2 transform -translate-y-1/2 z-10 bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-full shadow-lg transition-all duration-300 opacity-80 hover:opacity-100">
                <span class="material-icons">chevron_right</span>
            </button>
            {% endif %}
            
            <!-- Contenedor del carrusel -->
            <div id="novedades-carousel" class="flex transition-transform duration-500 ease-in-out" style="transform: translateX(0px);">
                {% for novedad in novedades_recientes %}
                <div class="flex-none w-full md:w-1/2 lg:w-1/3 px-3">
                    <div class="bg-gray-900 bg-opacity-90 rounded-lg overflow-hidden shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 cursor-pointer h-full flex flex-col"
                        style="height: 520px; min-height: 520px; max-height: 520px;"
                        onclick="openNovedadGallery({{ novedad.id }}, '{{ novedad.titulo|escapejs }}', '{{ novedad.descripcion|escapejs }}', '{{ novedad.fecha_creacion|date:"d/m/Y" }}', '{{ novedad.url_instagram|default:'' }}', [{% for img in novedad.imagenes.all %}'{{ img.imagen.url }}'{% if not forloop.last %},{% endif %}{% endfor %}])">
                        {% if novedad.imagenes.exists %}
                            <div class="h-80 overflow-hidden relative flex-shrink-0">
                                {% if novedad.imagenes.count == 1 %}
                                    <!-- Una sola imagen -->
                                    {% with novedad.imagenes.first as main_image %}
                                        <img src="{{ main_image.imagen.url }}" alt="{{ novedad.titulo }}" class="w-full h-full object-cover transition-transform duration-300 hover:scale-110">
                                    {% endwith %}
                                {% elif novedad.imagenes.count == 2 %}
                                    <!-- Dos imágenes en grid 2x1 -->
                                    <div class="grid grid-cols-2 gap-1 h-full">
                                        {% for img in novedad.imagenes.all|slice:":2" %}
                                            <img src="{{ img.imagen.url }}" alt="{{ novedad.titulo }}" class="w-full h-full object-cover transition-transform duration-300 hover:scale-110">
                                        {% endfor %}
                                    </div>
                                {% else %}
                                    <!-- Tres o más imágenes en grid especial -->
                                    <div class="grid grid-cols-2 gap-1 h-full">
                                        <!-- Imagen principal (primera) ocupa toda la columna izquierda -->
                                        {% with novedad.imagenes.first as main_image %}
                                            <img src="{{ main_image.imagen.url }}" alt="{{ novedad.titulo }}" class="w-full h-full object-cover transition-transform duration-300 hover:scale-110">
                                        {% endwith %}
                                        <!-- Columna derecha con hasta 2 imágenes más -->
                                        <div class="grid grid-rows-2 gap-1 h-full">
                                            {% for img in novedad.imagenes.all|slice:"1:3" %}
                                                <div class="relative overflow-hidden">
                                                    <img src="{{ img.imagen.url }}" alt="{{ novedad.titulo }}" class="w-full h-full object-cover transition-transform duration-300 hover:scale-110">
                                                    {% if forloop.last and novedad.imagenes.count > 3 %}
                                                        <!-- Overlay con número de imágenes adicionales -->
                                                        <div class="absolute inset-0 bg-black bg-opacity-60 flex items-center justify-center">
                                                            <span class="text-white text-lg font-bold">
                                                                +{{ novedad.imagenes.count|add:"-3" }}
                                                            </span>
                                                        </div>
                                                    {% endif %}
                                                </div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                {% endif %}
                                
                                <!-- Indicador de número total de imágenes -->
                                {% if novedad.imagenes.count > 1 %}
                                    <div class="absolute top-2 right-2 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded-full flex items-center gap-1">
                                        <span class="material-icons text-xs">photo_library</span>
                                        {{ novedad.imagenes.count }}
                                    </div>
                                {% endif %}
                                
                                <!-- Hover overlay -->
                                <div class="absolute inset-0 bg-black bg-opacity-0 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                                    <span class="material-icons text-white text-3xl opacity-0 hover:opacity-100 transition-opacity duration-300">fullscreen</span>
                                </div>
                            </div>
                        {% else %}
                            <div class="h-80 bg-gradient-to-br from-blue-900 to-purple-900 flex items-center justify-center flex-shrink-0">
                                <span class="material-icons text-white text-6xl opacity-50">article</span>
                            </div>
                        {% endif %}
                        <div class="py-2 px-4 flex-1 flex flex-col">
                            <h3 class="text-lg font-semibold text-white mb-2 line-clamp-2">{{ novedad.titulo }}</h3>
                            <p class="text-gray-300 text-sm mb-3 line-clamp-3 flex-1">{{ novedad.descripcion|truncatewords:20 }}</p>
                            <div class="flex justify-between items-center text-xs text-gray-400 mb-3">
                                <span>{{ novedad.fecha_creacion|date:"d/m/Y" }}</span>
                                {% if novedad.url_instagram %}
                                    <a href="{{ novedad.url_instagram }}" target="_blank" class="text-pink-400 hover:text-pink-300 flex items-center gap-1" onclick="event.stopPropagation();">
                                        <span class="material-icons text-sm">camera_alt</span>
                                        Instagram
                                    </a>
                                {% endif %}
                            </div>
                            {% if user.is_authenticated %}
                                <div class="flex gap-2 pt-2 border-t border-gray-700">
                                    <button onclick="event.stopPropagation(); openEditNovedadModal({{ novedad.id }})" class="flex-1 bg-yellow-600 hover:bg-yellow-700 text-white text-xs px-3 py-1 rounded transition">
                                        Editar
                                    </button>
                                    <button onclick="event.stopPropagation(); deleteNovedad({{ novedad.id }})" class="flex-1 bg-red-600 hover:bg-red-700 text-white text-xs px-3 py-1 rounded transition">
                                        Eliminar
                                    </button>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            
            <!-- Indicadores de posición -->
            <div id="novedades-indicators" class="flex justify-center mt-4 space-x-2">
                <!-- Los indicadores se generarán dinámicamente -->
            </div>
        </div>
    {% else %}
        <div class="text-center py-8">
            <span class="material-icons text-gray-500 text-6xl mb-4">article</span>
            <p class="text-gray-400">No hay novedades disponibles por el momento.</p>
        </div>
    {% endif %}
</section>

<!-- NUEVO: Próximos Partidos -->
<section class="mb-12 p-6 border-2 border-yellow-500 rounded-lg bg-gray-800 bg-opacity-80">
    <h2 class="text-xl font-semibold mb-4 text-center text-yellow-300">PRÓXIMOS PARTIDOS</h2>
    <div class="overflow-x-auto rounded-lg shadow">
        <table class="min-w-full bg-gray-900 text-gray-100 text-sm">
            <thead>
                <tr>
                    <th class="px-2 py-2">Fecha</th>
                    <th class="px-2 py-2">Hora</th>
                    <th class="px-2 py-2">Serie</th>
                    <th class="px-2 py-2">Fase</th>
                    <th class="px-2 py-2">Jornada</th>
                    <th class="px-2 py-2">Local</th>
                    <th class="px-2 py-2">Visita</th>
                    <th class="px-2 py-2">Cancha</th>
                </tr>
            </thead>
            <tbody>
                {% if proximos_partidos %}
                    {% for partido in proximos_partidos %}
                    <tr class="border-b border-gray-800 cursor-pointer hover:bg-red-900 transition"
                        data-partido-id="{{ partido.id }}"
                        onclick="irAPartido('{{ partido.serie_url }}', '{{ partido.jornada_id }}', '{{ partido.id }}')">
                        <td class="px-2 py-2 text-center">{{ partido.fecha }}</td>
                        <td class="px-2 py-2 text-center">{{ partido.hora }}</td>
                        <td class="px-2 py-2 text-center">{{ partido.serie }}</td>
                        <td class="px-2 py-2 text-center">{{ partido.fase }}</td>
                        <td class="px-2 py-2 text-center">{{ partido.jornada }}</td>
                        <td class="px-2 py-2 text-center">{{ partido.equipo_local }}</td>
                        <td class="px-2 py-2 text-center">{{ partido.equipo_visita }}</td>
                        <td class="px-2 py-2 text-center">{{ partido.cancha }}</td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="8" class="px-4 py-4 text-center text-gray-400">No hay partidos próximos registrados.</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</section>

<!-- NUEVO: Resultados recientes -->
<section class="mb-12 p-6 border-2 border-green-500 rounded-lg bg-gray-800 bg-opacity-80">
    <h2 class="text-xl font-semibold mb-4 text-center text-green-300">RESULTADOS RECIENTES</h2>
    <p class="text-center text-green-200 mb-6">Partidos de los últimos 5 días</p>
    <div class="overflow-x-auto rounded-lg shadow">
        <table class="min-w-full bg-gray-900 text-gray-100 text-sm">
            <thead>
                <tr>
                    <th class="px-2 py-2">Fecha</th>
                    <th class="px-2 py-2">Hora</th>
                    <th class="px-2 py-2">Serie</th>
                    <th class="px-2 py-2">Fase</th>
                    <th class="px-2 py-2">Jornada</th>
                    <th class="px-2 py-2">Local</th>
                    <th class="px-2 py-2">Goles</th>
                    <th class="px-2 py-2">Visita</th>
                    <th class="px-2 py-2">Goles</th>
                    <th class="px-2 py-2">Cancha</th>
                </tr>
            </thead>
            <tbody>
                {% if resultados_recientes %}
                    {% for partido in resultados_recientes %}
                    <tr class="border-b border-gray-800 cursor-pointer hover:bg-green-900 transition"
                        data-partido-id="{{ partido.id }}"
                        onclick="irAPartido('{{ partido.serie_url }}', '{{ partido.jornada_id }}', '{{ partido.id }}')">
                        <td class="px-2 py-2 text-center">{{ partido.fecha }}</td>
                        <td class="px-2 py-2 text-center">{{ partido.hora }}</td>
                        <td class="px-2 py-2 text-center">{{ partido.serie }}</td>
                        <td class="px-2 py-2 text-center">{{ partido.fase }}</td>
                        <td class="px-2 py-2 text-center">{{ partido.jornada }}</td>
                        <td class="px-2 py-2 text-center font-bold">{{ partido.equipo_local }}</td>
                        <td class="px-2 py-2 text-center text-lg font-semibold text-green-400">{{ partido.goles_local }}</td>
                        <td class="px-2 py-2 text-center font-bold">{{ partido.equipo_visita }}</td>
                        <td class="px-2 py-2 text-center text-lg font-semibold text-green-400">{{ partido.goles_visita }}</td>
                        <td class="px-2 py-2 text-center">{{ partido.cancha }}</td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="10" class="px-4 py-4 text-center text-gray-400">No hay resultados recientes registrados.</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</section>
<section class="mb-12 p-6 border-2 border-red-700 rounded-lg bg-gray-800 bg-opacity-80">
<h2 class="text-xl font-semibold mb-4 text-center text-red-300">NUESTROS CLUBES</h2>
<style>
    .club-carousel-bg {
        background: linear-gradient(135deg, #18171a 0%, #0d3a1d 100%);
        border-radius: 1rem;
        box-shadow: 0 4px 32px #000a;
    }
    .carousel-track {
        display: flex;
        align-items: center;
        gap: 3.5rem;
        will-change: transform;
        animation: scroll-left 38s linear infinite;
    }
    .carousel-row {
        overflow: hidden;
        width: 100%;
        height: 150px;
        position: relative;
    }
    @keyframes scroll-left {
        0% { transform: translateX(0); }
        100% { transform: translateX(-100%); }
    }
    .carousel-logo {
        border-radius: 0.75rem;
        padding: 0;
        box-shadow: none;
        transition: transform 0.3s;
        display: flex;
        flex-direction: column;
        align-items: center;
        background: none;
        min-width: 140px;
        max-width: 180px;
    }
    .carousel-logo img {
        height: 110px;
        max-width: 160px;
        width: auto;
        background: transparent;
        border-radius: 0.5rem;
        margin-bottom: 0.25rem;
        filter: drop-shadow(0 2px 8px #0008);
        transition: transform 0.3s;
        object-fit: contain;
    }
    .carousel-logo span {
        color: #eee;
        font-size: 0.9rem;
        font-weight: 600;
        text-align: center;
        text-shadow: 0 1px 2px #000a;
    }
    .carousel-logo:hover img {
        transform: scale(1.08);
    }
</style>
<div class="w-full club-carousel-bg py-6 px-2">
    <div class="carousel-row">
        <div class="carousel-track">
            <!-- Logos fila única (duplicados para loop infinito suave) -->
            <div class="carousel-logo">
                <img src="{% static 'img/barrera.png' %}" alt="Club Barrera">
                <span>Club Barrera</span>
            </div>
            <div class="carousel-logo">
                <img src="{% static 'img/colocolo_villarrica.png' %}" alt="Colo Colo Villarrica">
                <span>Colo Colo Villarrica</span>
            </div>
            <div class="carousel-logo">
                <img src="{% static 'img/pilmahue_villarrica.png' %}" alt="Pilmahue Villarrica">
                <span>Pilmahue Villarrica</span>
            </div>
            
            <div class="carousel-logo">
                <img src="{% static 'img/ferrovilla.png' %}" alt="Ferroviila Villarrica">
                <span>Ferroviila Villarrica</span>
            </div>
            <div class="carousel-logo">
                <img src="{% static 'img/anfa.png' %}" alt="ANFA Villarrica">
                <span>ANFA Villarrica</span>
            </div>
            
            <div class="carousel-logo">
                <img src="{% static 'img/kolping.png' %}" alt="Kolping Villarrica">
                <span>Kolping Villarrica</span>
            </div>
            
            <div class="carousel-logo">
                <img src="{% static 'img/catolica.png' %}" alt="CDUC Villarrica">
                <span>CDUC Villarrica</span>
            </div>
            <div class="carousel-logo">
                <img src="{% static 'img/lican.png' %}" alt="Unión Lican Ray">
                <span>Unión Lican Ray</span>
            </div>
            <div class="carousel-logo">
                <img src="{% static 'img/comercial.png' %}" alt="Comercial Villarrica">
                <span>Comercial Villarrica</span>
            </div>
            <div class="carousel-logo">
                <img src="{% static 'img/higins.png' %}" alt="O'Higgins Villarrica">
                <span>O'Higgins Villarrica</span>
            </div>
            
            <div class="carousel-logo">
                <img src="{% static 'img/club_villarrica.png' %}" alt="Club Deportivo Villarrica">
                <span>Club Deportivo Villarrica</span>
            </div>
            <!-- Duplicados para loop infinito suave -->
            <div class="carousel-logo">
                <img src="{% static 'img/barrera.png' %}" alt="Club Barrera">
                <span>Club Barrera</span>
            </div>
            <div class="carousel-logo">
                <img src="{% static 'img/colocolo_villarrica.png' %}" alt="Colo Colo Villarrica">
                <span>Colo Colo Villarrica</span>
            </div>
            <div class="carousel-logo">
                <img src="{% static 'img/pilmahue_villarrica.png' %}" alt="Pilmahue Villarrica">
                <span>Pilmahue Villarrica</span>
            </div>
            <div class="carousel-logo">
                <img src="{% static 'img/club3.png' %}" alt="Logo Blanco">
                <span>Logo Blanco</span>
            </div>
            <div class="carousel-logo">
                <img src="{% static 'img/ferrovilla.png' %}" alt="Ferroviila Villarrica">
                <span>Ferroviila Villarrica</span>
            </div>
            <div class="carousel-logo">
                <img src="{% static 'img/anfa.png' %}" alt="ANFA Villarrica">
                <span>ANFA Villarrica</span>
            </div>
            
            <div class="carousel-logo">
                <img src="{% static 'img/kolping.png' %}" alt="Kolping Villarrica">
                <span>Kolping Villarrica</span>
            </div>
            <div class="carousel-logo">
                <img src="{% static 'img/demarca.png' %}" alt="Demarca Sport">
                <span>Demarca Sport</span>
            </div>
            <div class="carousel-logo">
                <img src="{% static 'img/catolica.png' %}" alt="CDUC Villarrica">
                <span>CDUC Villarrica</span>
            </div>
            <div class="carousel-logo">
                <img src="{% static 'img/lican.png' %}" alt="Unión Lican Ray">
                <span>Unión Lican Ray</span>
            </div>
            <div class="carousel-logo">
                <img src="{% static 'img/comercial.png' %}" alt="Comercial Villarrica">
                <span>Comercial Villarrica</span>
            </div>
            <div class="carousel-logo">
                <img src="{% static 'img/higins.png' %}" alt="O'Higgins Villarrica">
                <span>O'Higgins Villarrica</span>
            </div>
            <div class="carousel-logo">
                <img src="{% static 'img/andes.png' %}" alt="Andes Asesorías">
                <span>Andes Asesorías</span>
            </div>
            <div class="carousel-logo">
                <img src="{% static 'img/club_villarrica.png' %}" alt="Club Deportivo Villarrica">
                <span>Club Deportivo Villarrica</span>
            </div>
        </div>
    </div>
</div>
</section>
<section class="p-6 border-2 border-red-700 rounded-lg bg-gray-800 bg-opacity-80">
<div class="flex justify-center mb-2">
    <span class="material-icons text-red-400 text-5xl drop-shadow-lg">emoji_events</span>
</div>
<h2 class="text-2xl font-extrabold mb-8 text-center text-red-400 tracking-wide flex items-center justify-center gap-2">
    CAMPEONATO DEMARCA SPORT ANFA VILLARRICA 2025
</h2>
<section class="py-12 bg-gradient-to-b from-gray-900 to-gray-800">
    <div class="container mx-auto px-4">
        <div class="flex flex-wrap justify-center gap-8">
            <!-- Infantiles: Primera, Segunda, Tercera -->
            <a href="{% url 'serie_primera_infantil' %}" class="group">
                <div class="relative bg-gray-800 bg-opacity-95 border-2 border-red-500 rounded-2xl shadow-xl p-8 w-64 flex flex-col items-center transform transition-all duration-300 hover:scale-105 hover:shadow-2xl hover:border-red-300">
                    <div class="absolute inset-0 bg-gradient-to-br from-red-500/20 to-red-600/20 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                    <span class="material-icons text-blue-400 text-5xl mb-4 group-hover:animate-pulse">sports_soccer</span>
                    <h3 class="text-xl font-semibold text-white tracking-tight">Primera Infantil</h3>
                    <p class="text-sm text-gray-300 mt-2">Competición para los más jóvenes talentos</p>
                </div>
            </a>
            <a href="{% url 'serie_segunda_infantil' %}" class="group">
                <div class="relative bg-gray-800 bg-opacity-95 border-2 border-white rounded-2xl shadow-xl p-8 w-64 flex flex-col items-center transform transition-all duration-300 hover:scale-105 hover:shadow-2xl hover:border-gray-300">
                    <div class="absolute inset-0 bg-gradient-to-br from-white/20 to-gray-300/20 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                    <span class="material-icons text-green-400 text-5xl mb-4 group-hover:animate-pulse">sports_soccer</span>
                    <h3 class="text-xl font-semibold text-white tracking-tight">Segunda Infantil</h3>
                    <p class="text-sm text-gray-300 mt-2">Desarrollo de habilidades en equipo</p>
                </div>
            </a>
            <a href="{% url 'serie_tercera_infantil' %}" class="group">
                <div class="relative bg-gray-800 bg-opacity-95 border-2 border-red-300 rounded-2xl shadow-xl p-8 w-64 flex flex-col items-center transform transition-all duration-300 hover:scale-105 hover:shadow-2xl hover:border-red-200">
                    <div class="absolute inset-0 bg-gradient-to-br from-red-300/20 to-red-400/20 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                    <span class="material-icons text-yellow-400 text-5xl mb-4 group-hover:animate-pulse">sports_soccer</span>
                    <h3 class="text-xl font-semibold text-white tracking-tight">Tercera Infantil</h3>
                    <p class="text-sm text-gray-300 mt-2">Iniciación al fútbol competitivo</p>
                </div>
            </a>
            <!-- Juvenil -->
            <a href="{% url 'serie_juvenil' %}" class="group">
                <div class="relative bg-gray-800 bg-opacity-95 border-2 border-red-600 rounded-2xl shadow-xl p-8 w-64 flex flex-col items-center transform transition-all duration-300 hover:scale-105 hover:shadow-2xl hover:border-red-400">
                    <div class="absolute inset-0 bg-gradient-to-br from-red-600/20 to-red-700/20 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                    <span class="material-icons text-indigo-400 text-5xl mb-4 group-hover:animate-pulse">sports_volleyball</span>
                    <h3 class="text-xl font-semibold text-white tracking-tight">Juvenil</h3>
                    <p class="text-sm text-gray-300 mt-2">Preparación para el siguiente nivel</p>
                </div>
            </a>
            <!-- Adultos -->
            <a href="{% url 'serie_honor' %}" class="group">
                <div class="relative bg-gray-800 bg-opacity-95 border-2 border-red-800 rounded-2xl shadow-xl p-8 w-64 flex flex-col items-center transform transition-all duration-300 hover:scale-105 hover:shadow-2xl hover:border-red-600">
                    <div class="absolute inset-0 bg-gradient-to-br from-red-800/20 to-red-900/20 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                    <span class="material-icons text-red-400 text-5xl mb-4 group-hover:animate-pulse">person</span>
                    <h3 class="text-xl font-semibold text-white tracking-tight">Primera Adultos Honor</h3>
                    <p class="text-sm text-gray-300 mt-2">Élite del fútbol adulto</p>
                </div>
            </a>
            <a href="{% url 'serie_segunda_adultos' %}" class="group">
                <div class="relative bg-gray-800 bg-opacity-95 border-2 border-red-400 rounded-2xl shadow-xl p-8 w-64 flex flex-col items-center transform transition-all duration-300 hover:scale-105 hover:shadow-2xl hover:border-red-300">
                    <div class="absolute inset-0 bg-gradient-to-br from-red-400/20 to-red-500/20 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                    <span class="material-icons text-teal-400 text-5xl mb-4 group-hover:animate-pulse">person</span>
                    <h3 class="text-xl font-semibold text-white tracking-tight">Segunda Adultos</h3>
                    <p class="text-sm text-gray-300 mt-2">Competencia de alto nivel</p>
                </div>
            </a>
            <!-- Seniors -->
            <a href="{% url 'serie_seniors' %}" class="group">
                <div class="relative bg-gray-800 bg-opacity-95 border-2 border-gray-300 rounded-2xl shadow-xl p-8 w-64 flex flex-col items-center transform transition-all duration-300 hover:scale-105 hover:shadow-2xl hover:border-white">
                    <div class="absolute inset-0 bg-gradient-to-br from-gray-300/20 to-white/20 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                    <span class="material-icons text-orange-400 text-5xl mb-4 group-hover:animate-pulse">person_4</span>
                    <h3 class="text-xl font-semibold text-white tracking-tight">Seniors</h3>
                    <p class="text-sm text-gray-300 mt-2">Experiencia y pasión</p>
                </div>
            </a>
            <a href="{% url 'serie_super_seniors' %}" class="group">
                <div class="relative bg-gray-800 bg-opacity-95 border-2 border-red-200 rounded-2xl shadow-xl p-8 w-64 flex flex-col items-center transform transition-all duration-300 hover:scale-105 hover:shadow-2xl hover:border-red-100">
                    <div class="absolute inset-0 bg-gradient-to-br from-red-200/20 to-red-300/20 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                    <span class="material-icons text-amber-400 text-5xl mb-4 group-hover:animate-pulse">person_4</span>
                    <h3 class="text-xl font-semibold text-white tracking-tight">Super Seniors</h3>
                    <p class="text-sm text-gray-300 mt-2">Leyendas del juego</p>
                </div>
            </a>
            <!-- Femenino -->
            <a href="{% url 'serie_femenino' %}" class="group">
                <div class="relative bg-gray-800 bg-opacity-95 border-2 border-pink-300 rounded-2xl shadow-xl p-8 w-64 flex flex-col items-center transform transition-all duration-300 hover:scale-105 hover:shadow-2xl hover:border-pink-200">
                    <div class="absolute inset-0 bg-gradient-to-br from-pink-300/20 to-pink-400/20 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                    <span class="material-icons text-pink-400 text-5xl mb-4 group-hover:animate-pulse">female</span>
                    <h3 class="text-xl font-semibold text-white tracking-tight">Femenino</h3>
                    <p class="text-sm text-gray-300 mt-2">Fuerza y talento femenino</p>
                </div>
            </a>
        </div>
    </div>
</section>
</main>
<footer class="text-center mt-12 py-4 border-t border-red-700">
<p class="text-sm text-red-300">© 2025 ANFA Villarrica. Todos los derechos reservados.</p>
</footer>
</div>
<!-- Modal para Agregar/Editar Novedad -->
<div id="novedadModal" class="fixed inset-0 bg-black bg-opacity-70 z-[9999] hidden flex items-start justify-center p-2 sm:p-4 overflow-y-auto">
    <div class="bg-gray-800 rounded-lg w-full max-w-md sm:max-w-lg md:max-w-xl shadow-2xl flex flex-col my-auto">
        <div class="flex justify-between items-center p-4 border-b border-gray-700">
            <h3 id="novedadModalTitle" class="text-lg font-semibold text-white">Agregar Novedad</h3>
            <button onclick="closeNovedadModal()" class="text-gray-400 hover:text-white">
                <span class="material-icons">close</span>
            </button>
        </div>
        <form id="novedadForm" enctype="multipart/form-data" class="p-4 space-y-4">
            {% csrf_token %}
            <input type="hidden" id="novedad_id" name="novedad_id">
            
            <div>
                <label for="titulo" class="block text-sm font-medium text-gray-300 mb-2">Título</label>
                <input type="text" id="titulo" name="titulo" required class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            </div>
            
            <div>
                <label for="descripcion" class="block text-sm font-medium text-gray-300 mb-2">Descripción</label>
                <textarea id="descripcion" name="descripcion" rows="4" required class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
            </div>
            
            <div>
                <label for="imagenes" class="block text-sm font-medium text-gray-300 mb-2">
                    Imágenes (máximo 5)
                    <span class="text-xs text-gray-400">- Puedes seleccionar múltiples imágenes</span>
                </label>
                <input type="file" id="imagenes" name="imagenes" accept="image/*" multiple class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <div id="imagenes-preview" class="mt-2 hidden">
                    <div class="grid grid-cols-2 gap-2" id="preview-container">
                        <!-- Preview images will be added here -->
                    </div>
                </div>
                <div id="existing-images" class="mt-2 hidden">
                    <p class="text-sm text-gray-400 mb-2">Imágenes actuales:</p>
                    <div class="grid grid-cols-2 gap-2" id="existing-container">
                        <!-- Existing images will be shown here -->
                    </div>
                </div>
            </div>
            
            <div>
                <label for="url_instagram" class="block text-sm font-medium text-gray-300 mb-2">URL de Instagram (opcional)</label>
                <input type="url" id="url_instagram" name="url_instagram" placeholder="https://www.instagram.com/p/..." class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            </div>
            
            <div class="flex gap-3 pt-4">
                <button type="submit" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition">
                    <span id="submitButtonText">Guardar</span>
                </button>
                <button type="button" onclick="closeNovedadModal()" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-4 rounded-lg transition">
                    Cancelar
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Modal para Galería de Imágenes de Novedad -->
<div id="novedadGalleryModal" class="fixed inset-0 bg-black bg-opacity-95 z-[9999] hidden overflow-y-auto">
    <div class="min-h-screen p-4 sm:p-6 flex items-center justify-center">
        <div class="w-full max-w-7xl bg-gray-900 rounded-lg overflow-hidden flex flex-col md:flex-row relative">
            <!-- Sección de Imagen -->
            <div class="w-full md:w-2/3 h-[40vh] md:h-[80vh] bg-black relative">
                <div id="imageContainer" class="w-full h-full flex items-center justify-center">
                    <img id="currentImage" src="" alt="" class="max-h-full max-w-full object-contain">
                    
                    <!-- Controles de navegación -->
                    <button id="prevButton" onclick="previousImage()" class="absolute left-2 top-1/2 -translate-y-1/2 bg-black/50 hover:bg-black/75 text-white p-2 rounded-full transition-all duration-200 hidden">
                        <span class="material-icons">chevron_left</span>
                    </button>
                    <button id="nextButton" onclick="nextImage()" class="absolute right-2 top-1/2 -translate-y-1/2 bg-black/50 hover:bg-black/75 text-white p-2 rounded-full transition-all duration-200 hidden">
                        <span class="material-icons">chevron_right</span>
                    </button>

                    <!-- Contador de imágenes -->
                    <div id="imageCounter" class="absolute top-4 right-4 bg-black/50 text-white px-3 py-1.5 rounded-full text-sm font-medium hidden">
                        <span id="currentImageNumber">1</span> / <span id="totalImages">1</span>
                    </div>
                </div>

                <!-- Thumbnails -->
                <div id="thumbnailContainer" class="absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2 px-4 py-2 bg-black/30 backdrop-blur-sm rounded-full hidden">
                    <!-- Thumbnails generados dinámicamente -->
                </div>
            </div>

            <!-- Panel de Información -->
            <div class="w-full md:w-1/3 max-h-[60vh] md:max-h-[80vh] flex flex-col bg-gray-900">
                <!-- Header fijo -->
                <div class="flex items-start justify-between p-4 border-b border-gray-800 bg-gray-900">
                    <div class="flex-1 min-w-0 pr-4">
                        <h3 id="galleryTitle" class="text-xl font-bold text-white truncate"></h3>
                        <p id="galleryDate" class="text-sm text-gray-400 mt-1"></p>
                    </div>
                    <button onclick="closeNovedadGallery()" class="text-gray-400 hover:text-white transition-colors">
                        <span class="material-icons">close</span>
                    </button>
                </div>

                <!-- Contenido scrolleable -->
                <div class="flex-1 overflow-y-auto p-4">
                    <div class="prose prose-invert max-w-none">
                        <p id="galleryDescription" class="text-gray-300 text-base leading-relaxed whitespace-pre-line"></p>
                    </div>
                </div>

                <!-- Footer fijo -->
                <div class="p-4 border-t border-gray-800 bg-gray-900">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-4">
                            <div class="flex items-center text-sm text-gray-400">
                                <span class="material-icons text-base mr-1.5">photo_library</span>
                                <span id="imageCount"></span>
                            </div>
                            <div class="flex items-center text-sm text-gray-400">
                                <span class="material-icons text-base mr-1.5">schedule</span>
                                <span id="galleryFullDate"></span>
                            </div>
                        </div>
                        <a id="galleryInstagramLink" href="#" target="_blank" 
                           class="hidden items-center gap-1.5 px-3 py-1.5 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-full text-sm font-medium hover:from-purple-700 hover:to-pink-700 transition-colors">
                            <span class="material-icons text-base">camera_alt</span>
                            Ver en Instagram
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function irAPartido(serieUrl, jornadaId, partidoId) {
    // Redirige a la url de la serie con hash de jornada y partido
    window.location.href = serieUrl + '#jornada-' + jornadaId + '-partido-' + partidoId;
}

// Funciones para manejo de novedades
function openAddNovedadModal() {
    document.getElementById('novedadModalTitle').textContent = 'Agregar Novedad';
    document.getElementById('submitButtonText').textContent = 'Guardar';
    document.getElementById('novedadForm').reset();
    document.getElementById('novedad_id').value = '';
    document.getElementById('imagenes-preview').classList.add('hidden');
    document.getElementById('existing-images').classList.add('hidden');
    document.getElementById('preview-container').innerHTML = '';
    
    // Ocultar el header
    const header = document.querySelector('.sticky-header');
    if (header) {
        header.style.display = 'none';
    }
    
    document.getElementById('novedadModal').classList.remove('hidden');
    document.body.style.overflow = 'hidden';
}

function openEditNovedadModal(novedadId) {
    fetch(`/novedades/edit/${novedadId}/`, {
        headers: {
            'X-Requested-With': 'XMLHttpRequest',
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.novedad) {
            document.getElementById('novedadModalTitle').textContent = 'Editar Novedad';
            document.getElementById('submitButtonText').textContent = 'Actualizar';
            document.getElementById('novedad_id').value = data.novedad.id;
            document.getElementById('titulo').value = data.novedad.titulo;
            document.getElementById('descripcion').value = data.novedad.descripcion;
            document.getElementById('url_instagram').value = data.novedad.url_instagram;
            
            // Mostrar imágenes existentes
            const existingContainer = document.getElementById('existing-container');
            existingContainer.innerHTML = '';
            
            if (data.novedad.imagenes_urls && data.novedad.imagenes_urls.length > 0) {
                data.novedad.imagenes_urls.forEach((url, index) => {
                    const imgDiv = document.createElement('div');
                    imgDiv.className = 'relative';
                    imgDiv.innerHTML = `
                        <img src="${url}" alt="Imagen ${index + 1}" class="w-full h-20 object-cover rounded">
                        <div class="absolute top-1 right-1 bg-black bg-opacity-50 text-white text-xs px-1 rounded">${index + 1}</div>
                    `;
                    existingContainer.appendChild(imgDiv);
                });
                document.getElementById('existing-images').classList.remove('hidden');
            }
            
            document.getElementById('imagenes-preview').classList.add('hidden');
            
            // Ocultar el header
            const header = document.querySelector('.sticky-header');
            if (header) {
                header.style.display = 'none';
            }
            
            document.getElementById('novedadModal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Error al cargar los datos de la novedad');
    });
}

function closeNovedadModal() {
    // Mostrar el header nuevamente
    const header = document.querySelector('.sticky-header');
    if (header) {
        header.style.display = 'flex';
    }
    
    document.getElementById('novedadModal').classList.add('hidden');
    document.body.style.overflow = 'auto';
}

function deleteNovedad(novedadId) {
    if (confirm('¿Estás seguro de que deseas eliminar esta novedad?')) {
        fetch(`/novedades/delete/${novedadId}/`, {
            method: 'POST',
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value,
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                location.reload();
            } else {
                alert('Error al eliminar la novedad');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Error al eliminar la novedad');
        });
    }
}

// Manejo del formulario de novedades
document.getElementById('novedadForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const novedadId = document.getElementById('novedad_id').value;
    const url = novedadId ? `/novedades/edit/${novedadId}/` : '/novedades/add/';
    
    fetch(url, {
        method: 'POST',
        body: formData,
        headers: {
            'X-Requested-With': 'XMLHttpRequest',
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            closeNovedadModal();
            location.reload();
        } else {
            alert('Error al guardar la novedad: ' + (data.error || 'Error desconocido'));
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Error al procesar la solicitud');
    });
});

// Preview de múltiples imágenes
document.getElementById('imagenes').addEventListener('change', function(e) {
    const files = Array.from(e.target.files);
    const previewContainer = document.getElementById('preview-container');
    previewContainer.innerHTML = '';
    
    if (files.length > 0) {
        if (files.length > 5) {
            alert('Máximo 5 imágenes permitidas. Solo se mostrarán las primeras 5.');
            // Limitar archivos a 5
            const limitedFiles = files.slice(0, 5);
            const dt = new DataTransfer();
            limitedFiles.forEach(file => dt.items.add(file));
            e.target.files = dt.files;
        }
        
        files.slice(0, 5).forEach((file, index) => {
            const reader = new FileReader();
            reader.onload = function(e) {
                const imgDiv = document.createElement('div');
                imgDiv.className = 'relative';
                imgDiv.innerHTML = `
                    <img src="${e.target.result}" alt="Preview ${index + 1}" class="w-full h-20 object-cover rounded">
                    <div class="absolute top-1 right-1 bg-black bg-opacity-50 text-white text-xs px-1 rounded">${index + 1}</div>
                `;
                previewContainer.appendChild(imgDiv);
            };
            reader.readAsDataURL(file);
        });
        
        document.getElementById('imagenes-preview').classList.remove('hidden');
        document.getElementById('existing-images').classList.add('hidden');
    } else {
        document.getElementById('imagenes-preview').classList.add('hidden');
    }
});

// Cerrar modal al hacer clic fuera
document.getElementById('novedadModal').addEventListener('click', function(e) {
    if (e.target === this) {
        closeNovedadModal();
    }
});

// Variables para la galería
let currentImages = [];
let currentImageIndex = 0;
let currentNovedadData = {};

// Funciones para la galería de novedades
function openNovedadGallery(id, titulo, descripcion, fecha, instagramUrl, imagenes) {
    currentImages = imagenes;
    currentImageIndex = 0;
    currentNovedadData = {
        id: id,
        titulo: titulo,
        descripcion: descripcion,
        fecha: fecha,
        instagramUrl: instagramUrl
    };
    
    // Llenar la información del modal
    document.getElementById('galleryTitle').textContent = titulo;
    document.getElementById('galleryDate').textContent = fecha;
    document.getElementById('galleryDescription').textContent = descripcion;
    document.getElementById('galleryFullDate').textContent = `Publicado el ${fecha}`;
    document.getElementById('imageCount').textContent = `${imagenes.length} imagen${imagenes.length > 1 ? 's' : ''}`;
    
    // Manejar enlace de Instagram
    const instagramLink = document.getElementById('galleryInstagramLink');
    if (instagramUrl) {
        instagramLink.href = instagramUrl;
        instagramLink.classList.remove('hidden');
    } else {
        instagramLink.classList.add('hidden');
    }
    
    // Mostrar la primera imagen
    if (imagenes.length > 0) {
        showImage(0);
        setupGalleryNavigation();
    }
    
    // Ocultar el header
    const header = document.querySelector('.sticky-header');
    if (header) {
        header.style.display = 'none';
    }
    
    document.getElementById('novedadGalleryModal').classList.remove('hidden');
    document.body.style.overflow = 'hidden'; // Prevenir scroll del fondo
}

function closeNovedadGallery() {
    // Mostrar el header nuevamente
    const header = document.querySelector('.sticky-header');
    if (header) {
        header.style.display = 'flex';
    }
    
    document.getElementById('novedadGalleryModal').classList.add('hidden');
    document.body.style.overflow = 'auto'; // Restaurar scroll
}

function showImage(index) {
    if (currentImages.length === 0) return;
    
    currentImageIndex = index;
    const currentImg = document.getElementById('currentImage');
    currentImg.src = currentImages[index];
    
    // Actualizar contador
    document.getElementById('currentImageNumber').textContent = index + 1;
    document.getElementById('totalImages').textContent = currentImages.length;
    
    // Mostrar/ocultar controles de navegación
    const prevBtn = document.getElementById('prevButton');
    const nextBtn = document.getElementById('nextButton');
    const counter = document.getElementById('imageCounter');
    
    if (currentImages.length > 1) {
        prevBtn.classList.toggle('hidden', index === 0);
        nextBtn.classList.toggle('hidden', index === currentImages.length - 1);
        counter.classList.remove('hidden');
        setupThumbnails();
    } else {
        prevBtn.classList.add('hidden');
        nextBtn.classList.add('hidden');
        counter.classList.add('hidden');
        document.getElementById('thumbnailContainer').classList.add('hidden');
    }
}

function previousImage() {
    if (currentImageIndex > 0) {
        showImage(currentImageIndex - 1);
    }
}

function nextImage() {
    if (currentImageIndex < currentImages.length - 1) {
        showImage(currentImageIndex + 1);
    }
}

function setupGalleryNavigation() {
    // Navegación con teclado
    document.addEventListener('keydown', handleGalleryKeyboard);
}

function handleGalleryKeyboard(e) {
    const modal = document.getElementById('novedadGalleryModal');
    if (modal.classList.contains('hidden')) return;
    
    switch(e.key) {
        case 'Escape':
            closeNovedadGallery();
            break;
        case 'ArrowLeft':
            previousImage();
            break;
        case 'ArrowRight':
            nextImage();
            break;
    }
}

function setupThumbnails() {
    const container = document.getElementById('thumbnailContainer');
    
    if (currentImages.length <= 1) {
        container.classList.add('hidden');
        return;
    }
    
    container.innerHTML = '';
    container.classList.remove('hidden');
    
    currentImages.forEach((img, index) => {
        const thumb = document.createElement('div');
        thumb.className = `w-12 h-12 rounded-lg overflow-hidden cursor-pointer border-2 transition-all duration-200 ${
            index === currentImageIndex ? 'border-blue-500 opacity-100' : 'border-gray-600 opacity-60 hover:opacity-80'
        }`;
        thumb.innerHTML = `<img src="${img}" alt="Thumbnail ${index + 1}" class="w-full h-full object-cover">`;
        thumb.onclick = () => showImage(index);
        container.appendChild(thumb);
    });
}

// Cerrar modal al hacer clic fuera de la imagen
document.getElementById('novedadGalleryModal').addEventListener('click', function(e) {
    if (e.target === this || e.target.id === 'imageContainer') {
        closeNovedadGallery();
    }
});

// Limpiar event listeners al cerrar
function closeNovedadGallery() {
    // Mostrar el header nuevamente
    const header = document.querySelector('.sticky-header');
    if (header) {
        header.style.display = 'flex';
    }
    
    document.getElementById('novedadGalleryModal').classList.add('hidden');
    document.body.style.overflow = 'auto';
    document.removeEventListener('keydown', handleGalleryKeyboard);
}

// Variables para el carrusel de novedades
let novedadesCurrentIndex = 0;
let novedadesAutoSlideInterval;
let novedadesTotalItems = 0;
let novedadesItemsPerView = 1;

// Inicializar carrusel de novedades
function initNovedadesCarousel() {
    const carousel = document.getElementById('novedades-carousel');
    if (!carousel) return;
    
    const items = carousel.children;
    novedadesTotalItems = items.length;
    
    if (novedadesTotalItems === 0) return;
    
    // Calcular items por vista según el tamaño de pantalla
    updateNovedadesItemsPerView();
    
    // Crear indicadores
    createNovedadesIndicators();
    
    // Actualizar controles iniciales
    updateNovedadesCarousel();
    
    // Iniciar auto-slide solo si hay suficientes elementos
    if (novedadesTotalItems > novedadesItemsPerView) {
        startNovedadesAutoSlide();
        
        // Pausar auto-slide al hover
        carousel.addEventListener('mouseenter', stopNovedadesAutoSlide);
        carousel.addEventListener('mouseleave', startNovedadesAutoSlide);
    }
    
    // Actualizar en resize
    window.addEventListener('resize', () => {
        updateNovedadesItemsPerView();
        updateNovedadesCarousel();
    });
}

function updateNovedadesItemsPerView() {
    if (window.innerWidth >= 1024) {
        novedadesItemsPerView = 3; // lg: 3 items
    } else if (window.innerWidth >= 768) {
        novedadesItemsPerView = 2; // md: 2 items
    } else {
        novedadesItemsPerView = 1; // sm: 1 item
    }
}

function createNovedadesIndicators() {
    const indicatorsContainer = document.getElementById('novedades-indicators');
    const maxIndex = Math.max(0, novedadesTotalItems - novedadesItemsPerView);
    
    if (maxIndex === 0) {
        indicatorsContainer.style.display = 'none';
        return;
    }
    
    indicatorsContainer.innerHTML = '';
    indicatorsContainer.style.display = 'flex';
    
    for (let i = 0; i <= maxIndex; i++) {
        const indicator = document.createElement('button');
        indicator.className = `w-2 h-2 rounded-full transition-all duration-300 ${
            i === novedadesCurrentIndex ? 'bg-blue-500' : 'bg-gray-600 hover:bg-gray-500'
        }`;
        indicator.onclick = () => goToNovedadesSlide(i);
        indicatorsContainer.appendChild(indicator);
    }
}

function updateNovedadesCarousel() {
    const carousel = document.getElementById('novedades-carousel');
    if (!carousel) return;
    
    const itemWidth = 100 / novedadesItemsPerView;
    const translateX = -(novedadesCurrentIndex * itemWidth);
    
    carousel.style.transform = `translateX(${translateX}%)`;
    
    // Actualizar indicadores
    const indicators = document.querySelectorAll('#novedades-indicators button');
    indicators.forEach((indicator, index) => {
        indicator.className = `w-2 h-2 rounded-full transition-all duration-300 ${
            index === novedadesCurrentIndex ? 'bg-blue-500' : 'bg-gray-600 hover:bg-gray-500'
        }`;
    });
    
    // Actualizar visibilidad de botones de navegación
    const prevBtn = document.getElementById('novedadesPrevBtn');
    const nextBtn = document.getElementById('novedadesNextBtn');
    const maxIndex = Math.max(0, novedadesTotalItems - novedadesItemsPerView);
    
    if (maxIndex === 0 || novedadesTotalItems <= novedadesItemsPerView) {
        // Ocultar botones si no hay suficientes elementos para navegar
        if (prevBtn) prevBtn.style.display = 'none';
        if (nextBtn) nextBtn.style.display = 'none';
    } else {
        // Mostrar botones y actualizar su opacidad
        if (prevBtn) {
            prevBtn.style.display = 'block';
            prevBtn.style.opacity = novedadesCurrentIndex === 0 ? '0.5' : '0.8';
        }
        if (nextBtn) {
            nextBtn.style.display = 'block';
            nextBtn.style.opacity = novedadesCurrentIndex >= maxIndex ? '0.5' : '0.8';
        }
    }
}

function moveNovedadesCarousel(direction) {
    const maxIndex = Math.max(0, novedadesTotalItems - novedadesItemsPerView);
    
    if (direction === 'next') {
        novedadesCurrentIndex = novedadesCurrentIndex >= maxIndex ? 0 : novedadesCurrentIndex + 1;
    } else {
        novedadesCurrentIndex = novedadesCurrentIndex <= 0 ? maxIndex : novedadesCurrentIndex - 1;
    }
    
    updateNovedadesCarousel();
}

function goToNovedadesSlide(index) {
    const maxIndex = Math.max(0, novedadesTotalItems - novedadesItemsPerView);
    novedadesCurrentIndex = Math.min(index, maxIndex);
    updateNovedadesCarousel();
}

function startNovedadesAutoSlide() {
    if (novedadesTotalItems <= novedadesItemsPerView) return;
    
    stopNovedadesAutoSlide();
    novedadesAutoSlideInterval = setInterval(() => {
        moveNovedadesCarousel('next');
    }, 5000); // Cambiar cada 5 segundos
}

function stopNovedadesAutoSlide() {
    if (novedadesAutoSlideInterval) {
        clearInterval(novedadesAutoSlideInterval);
        novedadesAutoSlideInterval = null;
    }
}

// Inicializar cuando la página se carga
document.addEventListener('DOMContentLoaded', function() {
    initNovedadesCarousel();
});
</script>
</body></html>